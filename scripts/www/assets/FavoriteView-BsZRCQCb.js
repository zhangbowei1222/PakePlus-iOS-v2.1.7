import{w as N,b as o,c as a,d as e,k as D,v as R,F as h,r as b,l as y,t as r,f as T,n as V,u as z,h as v,m as g,i as A,j as B}from"./index-Mrxc-rM3.js";import{u as M}from"./fundStore-1OjB7uIJ.js";import{a as $}from"./format-DZ_smWHi.js";import"./data-B6_LO-0g.js";const E={class:"page-content page-transition"},K={class:"fixed top-0 left-0 right-0 bg-gradient-to-r from-blue-50 to-indigo-50 py-3 px-4 z-50 border-b border-white/50 backdrop-blur-sm"},L={class:"flex items-center justify-between h-10 max-w-7xl mx-auto"},U={class:"relative"},q={key:1,class:"relative"},G={key:0,class:"absolute top-full left-0 right-0 mt-1 bg-white rounded-lg shadow-lg max-h-48 overflow-y-auto z-50"},H={key:0,class:"p-2"},J=["onClick"],O={class:"text-sm"},P={key:0,class:"text-primary text-sm"},Q={key:1,class:"text-neutral text-sm"},W={key:1,class:"p-2 text-neutral text-sm text-center"},X={class:"bg-white rounded-none p-5 mb-6 mt-16"},Y={class:"space-y-3"},Z={key:0,class:"text-center py-8 text-neutral"},ee={key:1},te=["onClick"],se={class:"flex justify-between items-center"},oe={class:"flex-1 min-w-0"},ae={class:"font-medium text-sm mb-0.5 truncate"},le={class:"text-xs text-neutral"},re={class:"flex items-center"},ne=["onClick"],ie={class:"flex justify-between text-xs mt-1.5 text-neutral"},pe={__name:"FavoriteView",setup(ce){const _=B(),n=M(),i=v(""),u=v(!1),c=v([]),d=v(!1),m=v(null),x=A(()=>n.favoriteFunds),p=l=>n.favoriteFunds.some(t=>t.code===l),k=l=>{_.push({name:"FundDetail",params:{code:l.code}})},w=async()=>{i.value?(await n.searchFunds(i.value),c.value=n.searchResults,u.value=i.value.length>0):(c.value=[],u.value=!1)},F=l=>{const t=c.value.find(s=>s.code===l);t&&!p(l)&&(n.addToFavorites(t),i.value="",c.value=[],u.value=!1,d.value=!1)},C=l=>{n.removeFromFavorites(l)},S=()=>{n.clearFavorites()},j=()=>{d.value=!0,g(()=>{m.value?.focus()})},I=()=>{d.value=!1,i.value="",c.value=[],u.value=!1};return N(d,l=>{l&&g(()=>{m.value?.focus()})}),(l,t)=>(o(),a("div",E,[e("nav",K,[e("div",L,[t[5]||(t[5]=e("div",{class:"flex items-center"},[e("i",{class:"fa fa-star text-primary mr-2"}),e("h1",{class:"text-base font-medium text-gray-800"},"自选基金")],-1)),e("div",U,[d.value?(o(),a("div",q,[D(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>i.value=s),type:"text",placeholder:"搜索基金代码/名称",class:"pl-8 pr-8 py-2 rounded-full border border-gray-200 focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary w-56 bg-white/90 backdrop-blur-sm text-xs",onInput:w,ref_key:"searchInput",ref:m},null,544),[[R,i.value]]),t[4]||(t[4]=e("i",{class:"fa fa-search absolute left-3 top-1/2 -translate-y-1/2 text-neutral text-xs"},null,-1)),e("button",{onClick:I,class:"absolute right-3 top-1/2 -translate-y-1/2 text-neutral hover:text-primary text-xs"},[...t[3]||(t[3]=[e("i",{class:"fa fa-times"},null,-1)])]),u.value?(o(),a("div",G,[c.value.length>0?(o(),a("div",H,[(o(!0),a(h,null,b(c.value,s=>(o(),a("div",{key:s.code,class:"p-2 hover:bg-gray-100 rounded cursor-pointer flex justify-between items-center transition-colors",onMousedown:t[1]||(t[1]=y(()=>{},["prevent"])),onClick:f=>!p(s.code)&&F(s.code)},[e("span",O,r(s.code)+" - "+r(s.name),1),p(s.code)?(o(),a("span",Q,"已添加")):(o(),a("span",P,"+添加"))],40,J))),128))])):(o(),a("div",W," 未找到相关基金 "))])):T("",!0)])):(o(),a("button",{key:0,onClick:j,class:"text-neutral hover:text-primary transition-colors p-2 rounded-full hover:bg-white/50"},[...t[2]||(t[2]=[e("i",{class:"fa fa-search"},null,-1)])]))])])]),e("div",X,[e("div",{class:"flex justify-between items-center mb-4"},[t[7]||(t[7]=e("h2",{class:"text-lg font-bold"},"我的自选基金",-1)),e("button",{onClick:S,class:"py-2 px-4 text-neutral border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium"},[...t[6]||(t[6]=[e("i",{class:"fa fa-trash mr-1"},null,-1),e("span",null,"清空自选",-1)])])]),e("div",Y,[x.value.length===0?(o(),a("div",Z,[...t[8]||(t[8]=[e("i",{class:"fa fa-star-o text-4xl mb-4 block"},null,-1),e("p",{class:"mb-2"},"暂无自选基金",-1),e("p",{class:"text-sm text-neutral"},"使用顶部搜索框搜索并添加基金",-1)])])):(o(),a("div",ee,[(o(!0),a(h,null,b(x.value,s=>(o(),a("div",{key:s.code,class:"border-b border-gray-100 hover:bg-gray-50 rounded-lg p-2 cursor-pointer fund-item hover-scale",onClick:f=>k(s)},[e("div",se,[e("div",oe,[e("h3",ae,r(s.name),1),e("span",le,r(s.code),1)]),e("div",re,[e("span",{class:V([z($)(s.change),"font-semibold mr-2 px-2 py-0.5 rounded text-xs"])},r(s.change>=0?"+":"")+r(Number(s.change).toFixed(2))+"% ",3),e("button",{onClick:y(f=>C(s.code),["stop"]),class:"text-neutral hover:text-rise transition-colors text-xs"},[...t[9]||(t[9]=[e("i",{class:"fa fa-times"},null,-1)])],8,ne)])]),e("div",ie,[e("span",null,"预估净值: "+r(s.estimateNav),1),e("span",null,"昨日净值: "+r(s.yesterdayNav),1)])],8,te))),128))]))])])]))}};export{pe as default};
