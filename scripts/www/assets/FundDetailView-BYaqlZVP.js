import{_ as qe,w as j,o as Ge,m as me,a as Ke,C as Qe,b as v,c as f,d as t,u as ne,t as a,n as R,f as F,F as P,r as M,p as X,k as p,v as C,q as E,s as O,e as Xe,x as et,h as x,j as tt,i as D}from"./index-Mrxc-rM3.js";import"./auto-fjZFdS-c.js";import{a as st,b as lt,c as at,d as nt,e as ot}from"./data-B6_LO-0g.js";import{u as rt}from"./fundStore-1OjB7uIJ.js";const ut={class:"fund-detail"},dt={class:"fixed top-0 left-0 right-0 z-50 detail-header"},it={class:"px-0 py-0"},ct={class:"flex items-center justify-between px-4 py-4"},vt={class:"text-center max-w-[200px] flex-1"},ft={class:"text-lg font-bold truncate"},mt={class:"text-sm opacity-90"},pt={class:"container mx-auto md:px-4 py-6 pt-16"},bt={key:0,class:"text-center py-8"},gt={key:1,class:"space-y-4"},xt={class:"bg-white rounded-xl p-5 card-shadow"},yt={class:"grid grid-cols-3 gap-4 mb-6"},ht={class:"text-center p-3"},wt={class:"text-xl font-bold"},kt={class:"text-center p-3"},Ct={class:"text-center p-3"},Dt={class:"text-xl font-bold"},St={key:0,class:"grid grid-cols-3 gap-4 mb-6"},Ft={class:"text-center p-3"},_t={class:"text-center p-3"},Tt={class:"text-lg font-bold"},At={class:"text-center p-3"},Nt={class:"text-lg font-bold"},Vt={class:"bg-white rounded-xl p-5 card-shadow"},Rt={class:"time-scroll-container mb-6"},Pt={class:"flex space-x-2"},jt=["onClick"],Mt={class:"chart-container"},$t={class:"bg-white rounded-xl p-5 card-shadow"},Ut={class:"flex items-center justify-between mb-4"},It={class:"overflow-x-auto"},Ot={class:"w-full"},Lt={class:"py-3 px-2 text-sm"},Jt={class:"py-3 px-2 text-sm font-medium"},zt={class:"py-3 px-2 text-sm font-medium"},Bt={class:"py-3 px-2"},Et={key:0},Wt={key:0,class:"bg-white rounded-xl p-5 card-shadow"},Yt={class:"flex flex-wrap gap-2"},Ht=["onClick"],Zt={key:1,class:"bg-white rounded-xl p-5 card-shadow"},qt={class:"space-y-3"},Gt={class:"flex-1"},Kt={class:"flex justify-between items-center mb-1"},Qt={class:"font-medium"},Xt={class:"flex justify-between text-sm"},es={class:"font-mono text-gray-600"},ts={class:"text-gray-500"},ss={class:"text-blue-600 font-medium"},ls={class:"bg-white rounded-xl p-5 card-shadow"},as={class:"grid grid-cols-2 gap-4"},ns={class:"flex justify-between items-center py-2 border-b border-gray-100"},os={class:"font-medium"},rs={class:"flex justify-between items-center py-2 border-b border-gray-100"},us={class:"font-medium"},ds={class:"flex justify-between items-center py-2 border-b border-gray-100"},is={class:"font-medium"},cs={class:"flex justify-between items-center py-2 border-b border-gray-100"},vs={class:"font-medium"},fs={class:"flex justify-between items-center py-2 border-b border-gray-100"},ms={class:"font-medium"},ps={class:"flex justify-between items-center py-2 border-b border-gray-100"},bs={class:"font-medium"},gs={key:2,class:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 z-40"},xs={class:"max-w-md mx-auto"},ys={class:"grid grid-cols-5 gap-2"},hs={key:2,class:"h-20"},ws={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},ks={class:"bg-white rounded-xl p-6 w-full max-w-sm"},Cs={class:"space-y-4"},Ds={class:"flex gap-3 mt-6"},Ss={key:1,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},Fs={class:"bg-white rounded-xl p-6 w-full max-w-sm"},_s={class:"space-y-4"},Ts={class:"text-xs text-gray-500 mt-1"},As={class:"text-xs text-gray-500 mt-1"},Ns={class:"flex gap-2"},Vs={class:"text-xs text-gray-500 mt-1"},Rs={class:"bg-gray-50 rounded-lg p-3"},Ps={class:"flex justify-between text-sm"},js={class:"font-medium"},Ms={class:"flex justify-between text-sm mt-1"},$s={class:"font-medium text-orange-600"},Us={class:"flex justify-between text-sm mt-1 font-bold border-t border-gray-200 pt-2"},Is={class:"text-blue-600"},Os=["max","min"],Ls={class:"flex gap-3"},Js={class:"flex items-center"},zs={class:"flex items-center"},Bs={class:"text-xs text-gray-500 mt-1"},Es={class:"flex gap-3 mt-6"},Ws={key:2,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},Ys={class:"bg-white rounded-xl p-6 w-full max-w-sm"},Hs={class:"space-y-4"},Zs={class:"block text-sm text-neutral mb-2"},qs={class:"grid grid-cols-4 gap-2"},Gs=["onClick"],Ks={class:"text-xs text-gray-500 mt-1"},Qs={class:"flex gap-2"},Xs={class:"text-xs text-gray-500 mt-1"},el={class:"bg-gray-50 rounded-lg p-3"},tl={class:"flex justify-between text-sm"},sl={class:"font-medium"},ll={class:"flex justify-between text-sm mt-1"},al={class:"font-medium text-orange-600"},nl={class:"flex justify-between text-sm mt-1 font-bold"},ol={class:"text-blue-600"},rl=["max","min"],ul={class:"flex gap-3"},dl={class:"flex items-center"},il={class:"flex items-center"},cl={class:"text-xs text-gray-500 mt-1"},vl={class:"flex gap-3 mt-6"},fl={key:3,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},ml={class:"bg-white rounded-xl p-6 w-full max-w-sm"},pl={class:"space-y-4"},bl={class:"text-xs text-gray-500 mt-1"},gl={class:"flex gap-2"},xl={class:"text-xs text-gray-500 mt-1"},yl={class:"bg-gray-50 rounded-lg p-3"},hl={class:"grid grid-cols-2 gap-4 text-sm"},wl={class:"flex justify-between"},kl={class:"font-medium"},Cl={class:"flex justify-between"},Dl={class:"font-medium text-orange-600"},Sl={class:"space-y-3"},Fl={class:"grid grid-cols-2 gap-3"},_l={class:"relative"},Tl={key:0,class:"relative"},Al={class:"block text-xs text-gray-500 mb-1"},Nl=["value"],Vl={key:1},Rl={class:"flex gap-3 mt-6"},Pl={key:4,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},jl={class:"bg-white rounded-xl p-6 w-full max-w-sm"},Ml={class:"space-y-4"},$l={class:"block text-sm text-neutral mb-2"},Ul={class:"grid grid-cols-4 gap-2"},Il=["onClick"],Ol={class:"flex gap-2"},Ll={class:"bg-gray-50 rounded-lg p-3"},Jl={class:"flex justify-between text-sm"},zl={class:"font-medium"},Bl={class:"flex justify-between text-sm mt-1"},El={class:"font-medium text-orange-600"},Wl={class:"flex justify-between text-sm mt-1 font-bold"},Yl={class:"text-blue-600"},Hl=["max","min"],Zl={class:"flex gap-3"},ql={class:"flex items-center"},Gl={class:"flex items-center"},Kl={class:"text-xs text-gray-500 mt-1"},Ql={class:"flex gap-3 mt-6"},Xl={__name:"FundDetailView",setup(ea){const oe={relatedSectors:[{name:"消费",change:2.35},{name:"科技",change:1.82},{name:"医药",change:-.45},{name:"新能源",change:3.15},{name:"金融",change:.68},{name:"制造业",change:1.42},{name:"互联网",change:2.18},{name:"半导体",change:1.95}]},W=et(),Y=tt(),k=rt(),y=W.params.code,n=x({}),N=x({}),_=x({}),L=x([]),ee=x([]),H=x("year"),Z=x(!1),q=x(null),te=x([]),J=x(!1),z=x(!1),$=x(!1),B=x(!1),U=x(!1),T=x({holdShare:0,costPrice:0,holdDays:0}),d=x({amount:null,fundType:"A",feeRate:.15,buyDate:"",buyTime:"before3"}),r=x({share:null,percentage:"",fundType:"A",feeRate:.5,sellDate:"",sellTime:"before3"}),pe=[{label:"1/2",value:"0.5"},{label:"1/3",value:"0.3333"},{label:"1/4",value:"0.25"},{label:"全部",value:"1"}],be=s=>{r.value.percentage=s.value,n.value.holdShare&&(r.value.share=n.value.holdShare*parseFloat(s.value))},i=x({amount:null,cycle:"",day:1,fundType:"A",feeRate:.15}),o=x({share:null,percentage:"",fromFundType:"A",toFundType:"A",feeRate:.5,targetCode:"",convertDate:"",convertTime:"before3"}),ge=[{label:"1/2",value:"0.5"},{label:"1/3",value:"0.3333"},{label:"1/4",value:"0.25"},{label:"全部",value:"1"}],xe=s=>{o.value.percentage=s.value,n.value.holdShare&&(o.value.share=n.value.holdShare*parseFloat(s.value))};console.log("121:",W.params.fund);const ye=()=>{if(W.params.fund){n.value=JSON.parse(decodeURIComponent(W.params.fund));return}const s=k.holdFunds.find(l=>l.code===y);if(s){n.value={...s};return}const e=k.favoriteFunds.find(l=>l.code===y);if(e){n.value={...e};return}n.value={code:y,name:"",nav:0,change:0,accumulatedNav:0}};j(J,s=>{s&&(T.value={holdShare:n.value.holdShare||0,costPrice:n.value.costPrice||0,holdDays:n.value.holdDays||0})}),j(z,s=>{if(s){const e=new Date;d.value.buyDate=e.toISOString().split("T")[0]}}),j($,s=>{if(s){const e=new Date;r.value.sellDate=e.toISOString().split("T")[0],r.value.share=null,r.value.percentage=""}}),j(B,s=>{if(s){const e=new Date;i.value.day=e.getDate()}}),j(()=>d.value.fundType,s=>{s==="C"?d.value.feeRate=0:s==="A"&&d.value.feeRate===0&&(d.value.feeRate=.15)}),j(()=>i.value.fundType,s=>{s==="C"?i.value.feeRate=0:s==="A"&&i.value.feeRate===0&&(i.value.feeRate=.15)}),j(U,s=>{if(s){const e=new Date;o.value.convertDate=e.toISOString().split("T")[0],o.value.share=null,o.value.percentage="",o.value.targetCode=""}});const re=D(()=>JSON.parse(localStorage.getItem("favoriteFunds")||"[]").some(e=>e.code===y)),he=D(()=>Z.value?L.value:L.value.slice(0,10)),A=(s,e=2)=>s==null||isNaN(s)?e===2?"0.00":"0.0000":parseFloat(s).toFixed(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),G=s=>{if(s==null||isNaN(s))return"0.00%";const e=parseFloat(s);return`${e>=0?"+":""}${e.toFixed(2)}%`},V=s=>s==null||isNaN(s)?"¥0.00":"¥"+parseFloat(s).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","),K=s=>s==null||isNaN(s)?"percent-neutral":parseFloat(s)>=0?"percent-rise":"percent-fall",we=s=>s==null||isNaN(s)?"percent-neutral":parseFloat(s)>=0?"percent-rise":"percent-fall",ke=D(()=>{if(!d.value.amount||d.value.amount<=0)return"0.00";const s=d.value.amount,e=se.value,u=(s-e)/g.value;return A(u,2)}),se=D(()=>{if(!d.value.amount||d.value.amount<=0)return 0;const s=(d.value.feeRate||0)/100;return d.value.amount*s}),le=D(()=>new Date().toISOString().split("T")[0]),ae=D(()=>{const s=new Date;return s.setDate(s.getDate()-30),s.toISOString().split("T")[0]}),ue=D(()=>{if(!r.value.share||r.value.share<=0)return 0;const s=r.value.share*g.value,e=(r.value.feeRate||0)/100;return s*e}),Ce=D(()=>{if(!r.value.share||r.value.share<=0)return 0;const s=r.value.share*g.value,e=ue.value;return s-e}),de=D(()=>{if(!o.value.share||o.value.share<=0)return 0;const s=o.value.share*g.value,e=(o.value.feeRate||0)/100;return s*e}),De=D(()=>{if(!o.value.share||o.value.share<=0)return 0;const s=o.value.share*g.value,e=de.value;return s-e}),Se=D(()=>{const s=new Date;return new Date(s.getFullYear(),s.getMonth()+1,0).getDate()}),Fe=()=>{switch(i.value.cycle){case"daily":return"定投时间";case"weekly":return"选择星期";case"biweekly":return"选择星期";case"monthly":return"选择日期";default:return"选择设置"}},_e=()=>{switch(i.value.cycle){case"daily":return[{label:"每天",value:1}];case"weekly":return[{label:"周一",value:1},{label:"周二",value:2},{label:"周三",value:3},{label:"周四",value:4},{label:"周五",value:5}];case"biweekly":return[{label:"周一",value:1},{label:"周二",value:2},{label:"周三",value:3},{label:"周四",value:4},{label:"周五",value:5}];case"monthly":const s=[];for(let e=1;e<=Se.value;e++)s.push({label:`${e}日`,value:e});return s;default:return[]}},ie=D(()=>{if(!i.value.amount||i.value.amount<=0)return 0;const s=(i.value.feeRate||0)/100;return i.value.amount*s}),Te=D(()=>{if(!i.value.amount||i.value.amount<=0)return"0.00";const s=i.value.amount,e=ie.value,u=(s-e)/g.value;return A(u,2)}),Ae=oe.detailTimePeriods,ce=x(oe.relatedSectors);let h=null;Ge(async()=>{ye(),await Ne(),await me(),fe(H.value)}),Ke(()=>{h&&(h.destroy(),h=null)});const Ne=async()=>{await Ve(),await Pe(),await $e(),await Re()},Ve=async()=>{try{const e=(await st(y,1,10)).data;e.ErrCode===0&&(L.value=e.Data.LSJZList.map(l=>({date:l.FSRQ,nav:l.DWJZ,accumulatedNav:l.LJJZ,change:l.JZZZL})))}catch(s){throw console.error("获取基金净值失败:",s),s}},Re=async()=>{const s=await lt(y);if(console.log("cc:",s),s&&s.content){const e=s.content.match(/id\s*=\s*["']?\s*gpdmList\s*["']?[^>]*>([\s\S]*?)<\/div>/i);if(e){const l=e[1];if(l){const b=(await at(l)).data.match(/\((.*)\)/);if(b&&b[1]){const w=JSON.parse(b[1]);w.data&&w.data.diff.length>0&&(ee.value=w.data.diff.map(c=>({code:c.f12,name:c.f14,change:c.f3,changeValue:c.f3/100*c.f2,marketValue:c.f2*c.f9,share:c.f9,market:c.f9/c.f2,position:c.f100})))}}}}},Pe=async()=>{const s=await nt(y);if(s&&s.Data_ACWorthTrend&&Array.isArray(s.Data_ACWorthTrend)){const e=s.Data_ACWorthTrend.map(l=>({timestamp:l[0],date:new Date(l[0]),value:l[1],formattedDate:je(new Date(l[0]))}));te.value=e,console.log("处理后的净值数据:",e.length,"条记录"),await me(),Me()}},je=s=>`${s.getFullYear()}-${(s.getMonth()+1).toString().padStart(2,"0")}-${s.getDate().toString().padStart(2,"0")}`,ve=s=>{const e=new Date,l=[...te.value];if(!l.length||s==="since")return l;let u=new Date;switch(s){case"this_year":u=new Date(e.getFullYear(),0,1);break;case"1m":u.setMonth(e.getMonth()-1);break;case"3m":u.setMonth(e.getMonth()-3);break;case"6m":u.setMonth(e.getMonth()-6);break;case"year":u.setFullYear(e.getFullYear()-1);break;case"3y":u.setFullYear(e.getFullYear()-3);break;case"5y":u.setFullYear(e.getFullYear()-5);break}return l.filter(b=>b.date>=u)},Me=()=>{if(!q.value)return;h&&h.destroy();const s=ve(H.value);if(!s.length)return;const e=s.map(m=>m.formattedDate),l=s.map(m=>m.value),b=(()=>{if(s.length<2)return"#e30505";const m=s[0].value;return s[s.length-1].value>=m?"#10b981":"#ef4444"})(),c=q.value.getContext("2d").createLinearGradient(0,0,0,400);c.addColorStop(0,`${b}20`),c.addColorStop(1,`${b}01`),h=new Qe(q.value,{type:"line",data:{labels:e,datasets:[{label:"单位净值",data:l,borderColor:b,backgroundColor:c,fill:!0,tension:.4,pointRadius:0,pointHoverRadius:4,borderWidth:2,pointBackgroundColor:b}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{mode:"index",intersect:!1,backgroundColor:"rgba(255, 255, 255, 0.95)",titleColor:"#1f2937",bodyColor:"#1f2937",borderColor:"#e5e7eb",borderWidth:1,cornerRadius:6,padding:12,displayColors:!1,callbacks:{title:m=>m[0].label,label:m=>`单位净值: ${m.parsed.y.toFixed(4)}`}}},scales:{x:{grid:{display:!1,drawBorder:!1},ticks:{maxTicksLimit:8,color:"#6b7280",font:{size:11},callback:function(m,S){if(S===0||S===this.getLabels().length-1||S===Math.floor(this.getLabels().length/2))return this.getLabels()[S];const I=new Date(this.getLabels()[S]);return`${I.getMonth()+1}-${I.getDate()}`}}},y:{position:"left",grid:{color:"#f3f4f6",drawBorder:!1},ticks:{color:"#6b7280",font:{size:11},callback:function(m){return m.toFixed(2)},stepSize:function(m){const S=m.chart.data.datasets[0].data,I=Math.max(...S),Ze=Math.min(...S),Q=I-Ze;return Q<.1?.01:Q<.5?.05:Q<1?.1:Q<5?.5:1}},beginAtZero:!1,min:function(m){const S=m.chart.data.datasets[0].data;return Math.min(...S)*.95},max:function(m){const S=m.chart.data.datasets[0].data;return Math.max(...S)*1.05}}},interaction:{intersect:!1,mode:"index"}}}),console.log("图表初始化完成，数据点数:",s.length)},fe=s=>{if(!h||!te.value.length)return;const e=ve(s),l=e.map(c=>c.formattedDate),u=e.map(c=>c.value),w=(()=>{if(e.length<2)return"#10b981";const c=e[0].value;return e[e.length-1].value>=c?"#10b981":"#ef4444"})();if(h.data.labels=l,h.data.datasets[0].data=u,h.data.datasets[0].borderColor=w,h.data.datasets[0].backgroundColor=w+"20",h.data.datasets[0].pointBackgroundColor=w,h.options.scales.y){const c=Math.min(...u)*.95,m=Math.max(...u)*1.05;h.options.scales.y.min=c,h.options.scales.y.max=m}h.update(),console.log("图表更新完成，周期:",s,"数据点数:",e.length)},$e=async()=>{const s=await ot(y),e=Ue(s);_.value={type:e.type,hosting:e.hosting,establishDate:e.establishDate,scale:e.scale,manager:e.manager,company:e.company},e.name&&!n.value.name&&(n.value.name=e.name)},Ue=s=>{const e={type:"",establishDate:"",scale:"",company:"",manager:""};return Object.entries({type:/<th[^>]*>基金类型<\/th>\s*<td[^>]*>([^<]+)/,establishDate:/<th[^>]*>成立日期[^<]*<\/th>\s*<td[^>]*>([^<]+)/,scale:/<th[^>]*>净资产规模<\/th>\s*<td[^>]*>([^<]+)/,company:/<th[^>]*>基金管理人<\/th>\s*<td[^>]*>[^<]*<a[^>]*>([^<]+)/,manager:/<th[^>]*>基金经理人<\/th>\s*<td[^>]*>[^<]*<a[^>]*>([^<]+)/,hosting:/<th[^>]*>基金托管人<\/th>\s*<td[^>]*>[^<]*<a[^>]*>([^<]+)/}).forEach(([u,b])=>{const w=s.match(b);if(w&&w[1]){let c=w[1].trim();u==="establishDate"&&(c=Ie(c)),e[u]=c}}),e},Ie=s=>{if(!s)return"";s=s.split(" / ")[0];const e=s.match(/(\d{4})年(\d{1,2})月(\d{1,2})日/);if(e){const l=e[1],u=e[2].padStart(2,"0"),b=e[3].padStart(2,"0");return`${l}-${u}-${b}`}return s},Oe=()=>{try{const s=JSON.parse(localStorage.getItem("favoriteFunds")||"[]");if(re.value){const e=s.findIndex(l=>l.code===y);e!==-1&&(s.splice(e,1),localStorage.setItem("favoriteFunds",JSON.stringify(s)),alert("已从自选移除"))}else{const e={code:y,name:n.value.name||_.value.company+"基金",estimateNav:n.value.nav||"1.0000",yesterdayNav:n.value.nav||"1.0000",change:n.value.change||0};s.push(e),localStorage.setItem("favoriteFunds",JSON.stringify(s)),alert("已添加到自选")}}catch(s){console.error("操作自选失败:",s),alert("操作失败，请重试")}},Le=s=>{H.value=s,fe(s)},Je=s=>{alert(`查看 ${s.name} 板块详情`)},ze=()=>{Y.push({name:"FundHistory",params:{code:y,name:N.name||n.value.name||"基金"}})},g=D(()=>N.value.nav||n.value.nav||1),Be=()=>{const s=k.holdFunds.findIndex(e=>e.code===y);if(s!==-1){const e=k.holdFunds[s];e.holdShare=T.value.holdShare,e.costPrice=T.value.costPrice,e.holdDays=T.value.holdDays,e.holdAmount=e.holdShare*(e.estimateNav||e.nav||g.value),e.holdProfit=(e.estimateNav||e.nav||g.value-e.costPrice)*e.holdShare,n.value={...e},J.value=!1,alert("基金信息修改成功！")}},Ee=()=>{const s=k.holdFunds.findIndex(e=>e.code===y);if(s!==-1){const e=k.holdFunds[s];if(!d.value.amount||d.value.amount<=0){alert("请输入加仓金额");return}if(!d.value.buyDate){alert("请选择原平台买入时间");return}const l=se.value,u=d.value.amount-l,b=u/g.value,w=e.holdShare*e.costPrice,c=u,m=e.holdShare+b;e.holdShare=m,e.costPrice=(w+c)/m,e.holdAmount=e.holdShare*(e.estimateNav||e.nav||g.value),e.holdProfit=(e.estimateNav||e.nav||g.value-e.costPrice)*e.holdShare,n.value={...e},d.value={amount:null,fundType:"A",feeRate:.15,buyDate:"",buyTime:"before3"},z.value=!1,alert("加仓成功！")}},We=()=>{const s=k.holdFunds.findIndex(e=>e.code===y);if(s!==-1){const e=k.holdFunds[s];let l=0;if(r.value.percentage)l=e.holdShare*parseFloat(r.value.percentage);else if(r.value.share&&r.value.share>0)l=r.value.share;else{alert("请选择减仓比例或输入减仓份额");return}if(l>e.holdShare){alert("减仓份额不能超过持有份额！");return}if(!r.value.sellDate){alert("请选择原平台卖出时间");return}if(e.holdShare=e.holdShare-l,e.holdShare<=.01)if(confirm("减仓后将不再持有该基金，是否继续？")){k.holdFunds.splice(s,1),$.value=!1,alert("减仓成功！该基金已从持仓中移除"),Y.back();return}else return;e.holdAmount=e.holdShare*(e.estimateNav||e.nav||g.value),e.holdProfit=(e.estimateNav||e.nav||g.value-e.costPrice)*e.holdShare,n.value={...e},r.value={share:null,percentage:"",fundType:"A",feeRate:.5,sellDate:"",sellTime:"before3"},$.value=!1,alert("减仓成功！")}},Ye=()=>{if(!i.value.amount||i.value.amount<=0){alert("请输入定投金额");return}const s=JSON.parse(localStorage.getItem("aipPlans")||"[]"),e={code:y,name:N.value.name||n.value.name,amount:i.value.amount,cycle:i.value.cycle,day:i.value.day,createTime:new Date().toISOString(),status:"active"},l=s.findIndex(u=>u.code===y);if(l!==-1)if(confirm("该基金已有定投计划，是否覆盖？"))s[l]=e;else return;else s.push(e);localStorage.setItem("aipPlans",JSON.stringify(s)),i.value={amount:null,cycle:"monthly",day:1},B.value=!1,alert("定投设置成功！")},He=()=>{const s=k.holdFunds.findIndex(e=>e.code===y);if(s!==-1){const e=k.holdFunds[s];let l=0;if(o.value.percentage)l=e.holdShare*parseFloat(o.value.percentage);else if(o.value.share&&o.value.share>0)l=o.value.share;else{alert("请选择转换比例或输入转换份额");return}if(l>e.holdShare){alert("转换份额不能超过持有份额！");return}if(!o.value.targetCode){alert("请输入目标基金代码");return}if(!o.value.convertDate){alert("请选择原平台转换时间");return}if(e.holdShare=e.holdShare-l,e.holdShare<=.01)if(confirm("转换后将不再持有该基金，是否继续？")){k.holdFunds.splice(s,1);const u=k.holdFunds.findIndex(b=>b.code===o.value.targetCode);if(u===-1)k.holdFunds.push({code:o.value.targetCode,name:"目标基金",holdShare:l,costPrice:g.value,holdDays:1,estimateNav:g.value,nav:g.value,change:0,holdAmount:l*g.value,holdProfit:0});else{const b=k.holdFunds[u],w=b.holdShare*b.costPrice,c=l*g.value,m=b.holdShare+l;b.holdShare=m,b.costPrice=(w+c)/m}U.value=!1,alert("转换成功！该基金已从持仓中移除，份额已转入目标基金"),Y.back();return}else return;e.holdAmount=e.holdShare*(e.estimateNav||e.nav||g.value),e.holdProfit=(e.estimateNav||e.nav||g.value-e.costPrice)*e.holdShare,n.value={...e},o.value={share:null,percentage:"",fromFundType:"A",toFundType:"A",feeRate:.5,targetCode:"",convertDate:"",convertTime:"before3"},U.value=!1,alert("转换成功！")}};return(s,e)=>(v(),f(P,null,[t("div",ut,[t("header",dt,[t("div",it,[t("div",ct,[t("button",{onClick:e[0]||(e[0]=l=>ne(Y).back()),class:"flex items-center space-x-2 detail-back-btn rounded-full p-2"},[...e[38]||(e[38]=[t("i",{class:"fa fa-arrow-left"},null,-1),t("span",{class:"text-sm font-medium"},"返回",-1)])]),t("div",vt,[t("h2",ft,a(N.value.name||n.value.name),1),t("p",mt,a(ne(y)),1)]),t("button",{onClick:Oe,class:"text-white"},[t("i",{class:R(["fa",re.value?"fa-star":"fa-star-o","text-lg"])},null,2)])])])]),t("main",pt,[s.loading?(v(),f("div",bt,[...e[39]||(e[39]=[t("i",{class:"fa fa-spinner fa-spin text-2xl text-primary"},null,-1),t("p",{class:"mt-2 text-neutral"},"加载中...",-1)])])):(v(),f("div",gt,[t("div",xt,[t("div",yt,[t("div",ht,[e[40]||(e[40]=t("p",{class:"text-neutral text-sm mb-1"},"单位净值",-1)),t("p",wt,a(A(N.value.nav||n.value.nav||0,4)),1)]),t("div",kt,[e[41]||(e[41]=t("p",{class:"text-neutral text-sm mb-1"},"日涨跌幅",-1)),t("p",{class:R(["text-xl font-bold",K(N.value.change||n.value.change||0)])},a(G(N.value.change||n.value.change||0)),3)]),t("div",Ct,[e[42]||(e[42]=t("p",{class:"text-neutral text-sm mb-1"},"累计净值",-1)),t("p",Dt,a(A(N.value.accumulatedNav||N.value.nav||n.value.accumulatedNav||n.value.nav||0,4)),1)])]),n.value.holdDays?(v(),f("div",St,[t("div",Ft,[e[43]||(e[43]=t("p",{class:"text-neutral text-sm mb-1"},"持有收益",-1)),t("p",{class:R(["text-lg font-bold",we(n.value.holdProfit||0)])},a(V(n.value.holdProfit||0)),3)]),t("div",_t,[e[44]||(e[44]=t("p",{class:"text-neutral text-sm mb-1"},"持有金额",-1)),t("p",Tt,a(V(n.value.holdAmount||0)),1)]),t("div",At,[e[45]||(e[45]=t("p",{class:"text-neutral text-sm mb-1"},"持仓成本",-1)),t("p",Nt,a(A(n.value.costPrice||0,4)),1)])])):F("",!0)]),t("div",Vt,[e[46]||(e[46]=t("div",{class:"flex items-center justify-between mb-4"},[t("h3",{class:"font-medium"},"净值走势")],-1)),t("div",Rt,[t("div",Pt,[(v(!0),f(P,null,M(ne(Ae),l=>(v(),f("button",{key:l.id,class:R(["time-tab whitespace-nowrap text-sm px-4 py-2 rounded-full transition-colors",H.value===l.id?"tab-active":"tab-inactive"]),onClick:u=>Le(l.id)},a(l.label),11,jt))),128))])]),t("div",Mt,[t("canvas",{ref_key:"fundChartCanvas",ref:q},null,512)])]),t("div",$t,[t("div",Ut,[e[49]||(e[49]=t("h3",{class:"font-medium"},"历史净值",-1)),!Z.value&&L.value.length>=10?(v(),f("button",{key:0,onClick:ze,class:"text-primary text-sm hover:text-primary/80 transition-colors"},[...e[47]||(e[47]=[X(" 查看更多 ",-1),t("i",{class:"fa fa-chevron-right ml-1"},null,-1)])])):Z.value?(v(),f("button",{key:1,onClick:e[1]||(e[1]=l=>Z.value=!1),class:"text-primary text-sm hover:text-primary/80 transition-colors"},[...e[48]||(e[48]=[X(" 收起 ",-1),t("i",{class:"fa fa-chevron-up ml-1"},null,-1)])])):F("",!0)]),t("div",It,[t("table",Ot,[e[51]||(e[51]=t("thead",null,[t("tr",{class:"border-b border-gray-100"},[t("th",{class:"text-left py-3 px-2 text-sm font-medium text-neutral"},"日期"),t("th",{class:"text-left py-3 px-2 text-sm font-medium text-neutral"},"单位净值"),t("th",{class:"text-left py-3 px-2 text-sm font-medium text-neutral"},"累计净值"),t("th",{class:"text-left py-3 px-2 text-sm font-medium text-neutral"},"日涨跌幅")])],-1)),t("tbody",null,[(v(!0),f(P,null,M(he.value,l=>(v(),f("tr",{key:l.date,class:"border-b border-gray-50 hover:bg-gray-50"},[t("td",Lt,a(l.date),1),t("td",Jt,a(l.nav),1),t("td",zt,a(l.accumulatedNav),1),t("td",Bt,[t("span",{class:R(["text-sm font-medium",K(l.change)])},a(G(l.change)),3)])]))),128)),L.value.length===0?(v(),f("tr",Et,[...e[50]||(e[50]=[t("td",{colspan:"4",class:"py-8 text-center text-neutral"},[t("i",{class:"fa fa-exclamation-circle text-2xl mb-2"}),t("p",null,"暂无历史数据")],-1)])])):F("",!0)])])])]),ce.value.length>0?(v(),f("div",Wt,[e[52]||(e[52]=t("h3",{class:"font-medium mb-4"},"关联板块",-1)),t("div",Yt,[(v(!0),f(P,null,M(ce.value,l=>(v(),f("span",{key:l.name,onClick:u=>Je(l),class:"px-3 py-1.5 bg-gray-100 text-neutral rounded-full text-sm hover:bg-gray-200 transition-colors cursor-pointer"},[X(a(l.name)+" ",1),t("span",{class:R(["ml-1 text-xs font-medium",K(l.change)])},a(G(l.change)),3)],8,Ht))),128))])])):F("",!0),ee.value.length>0?(v(),f("div",Zt,[e[54]||(e[54]=t("h3",{class:"font-medium mb-4"},"基金重仓股",-1)),t("div",qt,[(v(!0),f(P,null,M(ee.value,l=>(v(),f("div",{key:l.code,class:"flex items-center p-3 border border-gray-100 rounded-lg hover:bg-gray-50 transition-colors"},[t("div",Gt,[t("div",Kt,[t("h4",Qt,a(l.name),1),t("span",{class:R(["text-sm font-medium",K(l.change)])}," 涨跌幅: "+a(G(l.change)),3)]),t("div",Xt,[t("span",es,a(l.code),1),t("span",ts,[e[53]||(e[53]=X("所属板块: ",-1)),t("span",ss,a(l.position),1)])])])]))),128))])])):F("",!0),t("div",ls,[e[61]||(e[61]=t("h3",{class:"font-medium mb-4"},"基金信息",-1)),t("div",as,[t("div",ns,[e[55]||(e[55]=t("span",{class:"text-neutral"},"基金类型",-1)),t("span",os,a(_.value.type||"--"),1)]),t("div",rs,[e[56]||(e[56]=t("span",{class:"text-neutral"},"基金托管",-1)),t("span",us,a(_.value.hosting||"--"),1)]),t("div",ds,[e[57]||(e[57]=t("span",{class:"text-neutral"},"成立时间",-1)),t("span",is,a(_.value.establishDate?_.value.establishDate.split("/")[0]:"--"),1)]),t("div",cs,[e[58]||(e[58]=t("span",{class:"text-neutral"},"基金规模",-1)),t("span",vs,a(_.value.scale?_.value.scale.split("（")[0]:"--"),1)]),t("div",fs,[e[59]||(e[59]=t("span",{class:"text-neutral"},"基金经理",-1)),t("span",ms,a(_.value.manager||"--"),1)]),t("div",ps,[e[60]||(e[60]=t("span",{class:"text-neutral"},"基金公司",-1)),t("span",bs,a(_.value.company||"--"),1)])])]),n.value.holdDays?(v(),f("div",gs,[t("div",xs,[t("div",ys,[t("button",{onClick:e[2]||(e[2]=l=>J.value=!0),class:"flex flex-col items-center justify-center p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors"},[...e[62]||(e[62]=[t("i",{class:"fa fa-edit text-blue-600 text-lg mb-1"},null,-1),t("span",{class:"text-xs font-medium text-blue-700"},"修改",-1)])]),t("button",{onClick:e[3]||(e[3]=l=>z.value=!0),class:"flex flex-col items-center justify-center p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors"},[...e[63]||(e[63]=[t("i",{class:"fa fa-plus-circle text-green-600 text-lg mb-1"},null,-1),t("span",{class:"text-xs font-medium text-green-700"},"加仓",-1)])]),t("button",{onClick:e[4]||(e[4]=l=>$.value=!0),class:"flex flex-col items-center justify-center p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition-colors"},[...e[64]||(e[64]=[t("i",{class:"fa fa-minus-circle text-orange-600 text-lg mb-1"},null,-1),t("span",{class:"text-xs font-medium text-orange-700"},"减仓",-1)])]),t("button",{onClick:e[5]||(e[5]=l=>B.value=!0),class:"flex flex-col items-center justify-center p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors"},[...e[65]||(e[65]=[t("i",{class:"fa fa-calendar-check-o text-purple-600 text-lg mb-1"},null,-1),t("span",{class:"text-xs font-medium text-purple-700"},"定投",-1)])]),t("button",{onClick:e[6]||(e[6]=l=>U.value=!0),class:"flex flex-col items-center justify-center p-3 bg-indigo-50 hover:bg-indigo-100 rounded-lg transition-colors"},[...e[66]||(e[66]=[t("i",{class:"fa fa-exchange text-indigo-600 text-lg mb-1"},null,-1),t("span",{class:"text-xs font-medium text-indigo-700"},"转换",-1)])])])])])):F("",!0)])),n.value.holdDays?(v(),f("div",hs)):F("",!0)])]),J.value?(v(),f("div",ws,[t("div",ks,[e[70]||(e[70]=t("h3",{class:"text-lg font-bold mb-4"},"修改基金信息",-1)),t("div",Cs,[t("div",null,[e[67]||(e[67]=t("label",{class:"block text-sm text-neutral mb-2"},"持有份额",-1)),p(t("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>T.value.holdShare=l),type:"number",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[C,T.value.holdShare,void 0,{number:!0}]])]),t("div",null,[e[68]||(e[68]=t("label",{class:"block text-sm text-neutral mb-2"},"持仓成本",-1)),p(t("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>T.value.costPrice=l),type:"number",step:"0.0001",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[C,T.value.costPrice,void 0,{number:!0}]])]),t("div",null,[e[69]||(e[69]=t("label",{class:"block text-sm text-neutral mb-2"},"持有天数",-1)),p(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>T.value.holdDays=l),type:"number",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[C,T.value.holdDays,void 0,{number:!0}]])])]),t("div",Ds,[t("button",{onClick:e[10]||(e[10]=l=>J.value=!1),class:"flex-1 py-2 border border-gray-300 rounded-lg font-medium"}," 取消 "),t("button",{onClick:Be,class:"flex-1 py-2 bg-blue-600 text-white rounded-lg font-medium"},"确认修改 ")])])])):F("",!0),z.value?(v(),f("div",Ss,[t("div",Fs,[e[84]||(e[84]=t("h3",{class:"text-lg font-bold mb-4"},"同步加仓",-1)),t("div",_s,[t("div",null,[e[71]||(e[71]=t("label",{class:"block text-sm text-neutral mb-2"},"加仓金额",-1)),p(t("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>d.value.amount=l),type:"number",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请输入加仓金额"},null,512),[[C,d.value.amount,void 0,{number:!0}]]),t("p",Ts,"当前净值: "+a(A(g.value,4))+"元",1)]),t("div",null,[e[73]||(e[73]=t("label",{class:"block text-sm text-neutral mb-2"},"基金类型",-1)),p(t("select",{"onUpdate:modelValue":e[12]||(e[12]=l=>d.value.fundType=l),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[72]||(e[72]=[t("option",{value:"A"},"A类基金",-1),t("option",{value:"C"},"C类基金",-1)])],512),[[E,d.value.fundType]]),t("p",As,a(d.value.fundType==="A"?"A类基金：申购费0.1%-1.5%，无销售服务费":"C类基金：无申购费，销售服务费0.2%-0.8%/年"),1)]),t("div",null,[e[75]||(e[75]=t("label",{class:"block text-sm text-neutral mb-2"},"买入费率",-1)),t("div",Ns,[p(t("input",{"onUpdate:modelValue":e[13]||(e[13]=l=>d.value.feeRate=l),type:"number",step:"0.001",min:"0",max:"5",class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"费率%"},null,512),[[C,d.value.feeRate,void 0,{number:!0}]]),e[74]||(e[74]=t("span",{class:"px-3 py-2 text-gray-600"},"%",-1))]),t("p",Vs,a(d.value.fundType==="A"?"建议：0.1%-1.5%":"建议：0%"),1)]),t("div",Rs,[t("div",Ps,[e[76]||(e[76]=t("span",{class:"text-neutral"},"估算份额:",-1)),t("span",js,a(ke.value)+"份",1)]),t("div",Ms,[e[77]||(e[77]=t("span",{class:"text-neutral"},"估算手续费:",-1)),t("span",$s,a(V(se.value)),1)]),t("div",Us,[e[78]||(e[78]=t("span",null,"实际支付:",-1)),t("span",Is,a(V(d.value.amount||0)),1)]),e[79]||(e[79]=t("p",{class:"text-xs text-gray-500 mt-2"},"* 手续费已从加仓金额中扣除",-1))]),t("div",null,[e[80]||(e[80]=t("label",{class:"block text-sm text-neutral mb-2"},"原平台买入时间",-1)),p(t("input",{"onUpdate:modelValue":e[14]||(e[14]=l=>d.value.buyDate=l),type:"date",max:le.value,min:ae.value,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,Os),[[C,d.value.buyDate]])]),t("div",null,[e[83]||(e[83]=t("label",{class:"block text-sm text-neutral mb-2"},"买入时间",-1)),t("div",Ls,[t("label",Js,[p(t("input",{"onUpdate:modelValue":e[15]||(e[15]=l=>d.value.buyTime=l),type:"radio",value:"before3",class:"mr-2"},null,512),[[O,d.value.buyTime]]),e[81]||(e[81]=t("span",{class:"text-sm"},"下午3点前",-1))]),t("label",zs,[p(t("input",{"onUpdate:modelValue":e[16]||(e[16]=l=>d.value.buyTime=l),type:"radio",value:"after3",class:"mr-2"},null,512),[[O,d.value.buyTime]]),e[82]||(e[82]=t("span",{class:"text-sm"},"下午3点后",-1))])]),t("p",Bs,a(d.value.buyTime==="before3"?"按今日净值计算":"按明日净值计算"),1)])]),t("div",Es,[t("button",{onClick:e[17]||(e[17]=l=>z.value=!1),class:"flex-1 py-2 border border-gray-300 rounded-lg font-medium"},"取消 "),t("button",{onClick:Ee,class:"flex-1 py-2 bg-green-600 text-white rounded-lg font-medium"},"确认加仓")])])])):F("",!0),$.value?(v(),f("div",Ws,[t("div",Ys,[e[97]||(e[97]=t("h3",{class:"text-lg font-bold mb-4"},"同步减仓",-1)),t("div",Hs,[t("div",null,[t("label",Zs,"当前持有: "+a(A(n.value.holdShare||0,2))+"份",1),p(t("input",{"onUpdate:modelValue":e[18]||(e[18]=l=>r.value.share=l),type:"number",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请输入减仓份额"},null,512),[[C,r.value.share,void 0,{number:!0}]])]),t("div",null,[e[85]||(e[85]=t("label",{class:"block text-sm text-neutral mb-2"},"快速选择减仓比例",-1)),t("div",qs,[(v(),f(P,null,M(pe,l=>t("button",{key:l.value,onClick:u=>be(l),class:R(["py-2 px-2 text-sm rounded-lg border transition-colors",r.value.percentage===l.value?"bg-orange-100 border-orange-300 text-orange-700":"bg-white border-gray-300 hover:bg-gray-50"])},a(l.label),11,Gs)),64))])]),t("div",null,[e[87]||(e[87]=t("label",{class:"block text-sm text-neutral mb-2"},"基金类型",-1)),p(t("select",{"onUpdate:modelValue":e[19]||(e[19]=l=>r.value.fundType=l),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[86]||(e[86]=[t("option",{value:"A"},"A类基金",-1),t("option",{value:"C"},"C类基金",-1)])],512),[[E,r.value.fundType]]),t("p",Ks,a(r.value.fundType==="A"?"A类基金：持有<7天1.5%，1年以内0.5%，1-2年0.25%，2年以上0%":"C类基金：持有<7天1.5%，30天以内0.5%，30天以上0%"),1)]),t("div",null,[e[89]||(e[89]=t("label",{class:"block text-sm text-neutral mb-2"},"赎回费率",-1)),t("div",Qs,[p(t("input",{"onUpdate:modelValue":e[20]||(e[20]=l=>r.value.feeRate=l),type:"number",step:"0.001",min:"0",max:"5",class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"费率%"},null,512),[[C,r.value.feeRate,void 0,{number:!0}]]),e[88]||(e[88]=t("span",{class:"px-3 py-2 text-gray-600"},"%",-1))]),t("p",Xs,a(r.value.fundType==="A"?"建议：根据持有时间0%-1.5%":"建议：持有30天以上0%"),1)]),t("div",el,[t("div",tl,[e[90]||(e[90]=t("span",{class:"text-neutral"},"减仓份额:",-1)),t("span",sl,a(A(r.value.share||0,2))+"份",1)]),t("div",ll,[e[91]||(e[91]=t("span",{class:"text-neutral"},"估算手续费:",-1)),t("span",al,a(V(ue.value)),1)]),t("div",nl,[e[92]||(e[92]=t("span",null,"预计到账:",-1)),t("span",ol,a(V(Ce.value)),1)])]),t("div",null,[e[93]||(e[93]=t("label",{class:"block text-sm text-neutral mb-2"},"原平台卖出时间",-1)),p(t("input",{"onUpdate:modelValue":e[21]||(e[21]=l=>r.value.sellDate=l),type:"date",max:le.value,min:ae.value,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,rl),[[C,r.value.sellDate]])]),t("div",null,[e[96]||(e[96]=t("label",{class:"block text-sm text-neutral mb-2"},"卖出时间",-1)),t("div",ul,[t("label",dl,[p(t("input",{"onUpdate:modelValue":e[22]||(e[22]=l=>r.value.sellTime=l),type:"radio",value:"before3",class:"mr-2"},null,512),[[O,r.value.sellTime]]),e[94]||(e[94]=t("span",{class:"text-sm"},"下午3点前",-1))]),t("label",il,[p(t("input",{"onUpdate:modelValue":e[23]||(e[23]=l=>r.value.sellTime=l),type:"radio",value:"after3",class:"mr-2"},null,512),[[O,r.value.sellTime]]),e[95]||(e[95]=t("span",{class:"text-sm"},"下午3点后",-1))])]),t("p",cl,a(r.value.sellTime==="before3"?"按今日净值计算":"按明日净值计算"),1)])]),t("div",vl,[t("button",{onClick:e[24]||(e[24]=l=>$.value=!1),class:"flex-1 py-2 border border-gray-300 rounded-lg font-medium"}," 取消 "),t("button",{onClick:We,class:"flex-1 py-2 bg-orange-600 text-white rounded-lg font-medium"},"确认减仓 ")])])])):F("",!0),B.value?(v(),f("div",fl,[t("div",ml,[e[110]||(e[110]=t("h3",{class:"text-lg font-bold mb-4"},"同步定投",-1)),t("div",pl,[t("div",null,[e[98]||(e[98]=t("label",{class:"block text-sm text-neutral mb-2"},"定投金额",-1)),p(t("input",{"onUpdate:modelValue":e[25]||(e[25]=l=>i.value.amount=l),type:"number",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请输入每次定投金额"},null,512),[[C,i.value.amount,void 0,{number:!0}]])]),t("div",null,[e[100]||(e[100]=t("label",{class:"block text-sm text-neutral mb-2"},"基金类型",-1)),p(t("select",{"onUpdate:modelValue":e[26]||(e[26]=l=>i.value.fundType=l),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[99]||(e[99]=[t("option",{value:"A"},"A类基金",-1),t("option",{value:"C"},"C类基金",-1)])],512),[[E,i.value.fundType]]),t("p",bl,a(i.value.fundType==="A"?"A类基金：申购费0.1%-1.5%，无销售服务费":"C类基金：无申购费，销售服务费0.2%-0.8%/年"),1)]),t("div",null,[e[102]||(e[102]=t("label",{class:"block text-sm text-neutral mb-2"},"买入费率",-1)),t("div",gl,[p(t("input",{"onUpdate:modelValue":e[27]||(e[27]=l=>i.value.feeRate=l),type:"number",step:"0.001",min:"0",max:"5",class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"费率%"},null,512),[[C,i.value.feeRate,void 0,{number:!0}]]),e[101]||(e[101]=t("span",{class:"px-3 py-2 text-gray-600"},"%",-1))]),t("p",xl,a(i.value.fundType==="A"?"建议：0.1%-1.5%":"建议：0%"),1)]),t("div",yl,[t("div",hl,[t("div",wl,[e[103]||(e[103]=t("span",{class:"text-neutral"},"估算份额:",-1)),t("span",kl,a(Te.value)+"份",1)]),t("div",Cl,[e[104]||(e[104]=t("span",{class:"text-neutral"},"估算手续费:",-1)),t("span",Dl,a(V(ie.value)),1)])])]),t("div",Sl,[e[109]||(e[109]=t("label",{class:"block text-sm text-neutral"},"定投设置",-1)),t("div",Fl,[t("div",_l,[e[106]||(e[106]=t("label",{class:"block text-xs text-gray-500 mb-1"},"定投周期",-1)),p(t("select",{"onUpdate:modelValue":e[28]||(e[28]=l=>i.value.cycle=l),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 appearance-none bg-white"},[...e[105]||(e[105]=[Xe('<option value="" data-v-0a1cf319>选择周期</option><option value="daily" data-v-0a1cf319>每日</option><option value="weekly" data-v-0a1cf319>每周</option><option value="biweekly" data-v-0a1cf319>每两周</option><option value="monthly" data-v-0a1cf319>每月</option>',5)])],512),[[E,i.value.cycle]]),e[107]||(e[107]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("i",{class:"fa fa-chevron-down text-xs"})],-1))]),i.value.cycle?(v(),f("div",Tl,[t("label",Al,a(Fe()),1),p(t("select",{"onUpdate:modelValue":e[29]||(e[29]=l=>i.value.day=l),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 appearance-none bg-white"},[(v(!0),f(P,null,M(_e(),l=>(v(),f("option",{key:l.value,value:l.value},a(l.label),9,Nl))),128))],512),[[E,i.value.day]]),e[108]||(e[108]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("i",{class:"fa fa-chevron-down text-xs"})],-1))])):(v(),f("div",Vl))])])]),t("div",Rl,[t("button",{onClick:e[30]||(e[30]=l=>B.value=!1),class:"flex-1 py-2 border border-gray-300 rounded-lg font-medium"},"取消 "),t("button",{onClick:Ye,class:"flex-1 py-2 bg-purple-600 text-white rounded-lg font-medium"},"设置定投 ")])])])):F("",!0),U.value?(v(),f("div",Pl,[t("div",jl,[e[123]||(e[123]=t("h3",{class:"text-lg font-bold mb-4"},"基金转换",-1)),t("div",Ml,[t("div",null,[t("label",$l,"当前持有: "+a(A(n.value.holdShare||0,2))+"份",1),p(t("input",{"onUpdate:modelValue":e[31]||(e[31]=l=>o.value.share=l),type:"number",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请输入转换份额"},null,512),[[C,o.value.share,void 0,{number:!0}]])]),t("div",null,[e[111]||(e[111]=t("label",{class:"block text-sm text-neutral mb-2"},"快速选择转换比例",-1)),t("div",Ul,[(v(),f(P,null,M(ge,l=>t("button",{key:l.value,onClick:u=>xe(l),class:R(["py-2 px-2 text-sm rounded-lg border transition-colors",o.value.percentage===l.value?"bg-indigo-100 border-indigo-300 text-indigo-700":"bg-white border-gray-300 hover:bg-gray-50"])},a(l.label),11,Il)),64))])]),t("div",null,[e[113]||(e[113]=t("label",{class:"block text-sm text-neutral mb-2"},"转换费率",-1)),t("div",Ol,[p(t("input",{"onUpdate:modelValue":e[32]||(e[32]=l=>o.value.feeRate=l),type:"number",step:"0.001",min:"0",max:"5",class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"费率%"},null,512),[[C,o.value.feeRate,void 0,{number:!0}]]),e[112]||(e[112]=t("span",{class:"px-3 py-2 text-gray-600"},"%",-1))]),e[114]||(e[114]=t("p",{class:"text-xs text-gray-500 mt-1"},"建议：补差申购费或赎回费的较低者",-1))]),t("div",Ll,[t("div",Jl,[e[115]||(e[115]=t("span",{class:"text-neutral"},"转换份额:",-1)),t("span",zl,a(A(o.value.share||0,2))+"份",1)]),t("div",Bl,[e[116]||(e[116]=t("span",{class:"text-neutral"},"估算手续费:",-1)),t("span",El,a(V(de.value)),1)]),t("div",Wl,[e[117]||(e[117]=t("span",null,"预计转入价值:",-1)),t("span",Yl,a(V(De.value)),1)])]),t("div",null,[e[118]||(e[118]=t("label",{class:"block text-sm text-neutral mb-2"},"目标基金代码",-1)),p(t("input",{"onUpdate:modelValue":e[33]||(e[33]=l=>o.value.targetCode=l),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请输入目标基金代码"},null,512),[[C,o.value.targetCode]])]),t("div",null,[e[119]||(e[119]=t("label",{class:"block text-sm text-neutral mb-2"},"原平台转换时间",-1)),p(t("input",{"onUpdate:modelValue":e[34]||(e[34]=l=>o.value.convertDate=l),type:"date",max:le.value,min:ae.value,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,Hl),[[C,o.value.convertDate]])]),t("div",null,[e[122]||(e[122]=t("label",{class:"block text-sm text-neutral mb-2"},"转换时间",-1)),t("div",Zl,[t("label",ql,[p(t("input",{"onUpdate:modelValue":e[35]||(e[35]=l=>o.value.convertTime=l),type:"radio",value:"before3",class:"mr-2"},null,512),[[O,o.value.convertTime]]),e[120]||(e[120]=t("span",{class:"text-sm"},"下午3点前",-1))]),t("label",Gl,[p(t("input",{"onUpdate:modelValue":e[36]||(e[36]=l=>o.value.convertTime=l),type:"radio",value:"after3",class:"mr-2"},null,512),[[O,o.value.convertTime]]),e[121]||(e[121]=t("span",{class:"text-sm"},"下午3点后",-1))])]),t("p",Kl,a(o.value.convertTime==="before3"?"按今日净值计算":"按明日净值计算"),1)])]),t("div",Ql,[t("button",{onClick:e[37]||(e[37]=l=>U.value=!1),class:"flex-1 py-2 border border-gray-300 rounded-lg font-medium"}," 取消 "),t("button",{onClick:He,class:"flex-1 py-2 bg-indigo-600 text-white rounded-lg font-medium"},"确认转换 ")])])])):F("",!0)],64))}},na=qe(Xl,[["__scopeId","data-v-0a1cf319"]]);export{na as default};
